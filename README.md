# STQCL

Run the basic point output by runing:

```shell
python -u point.py -model stgcn_point -data pems03 -note stgcn_point_pems03 -loss masked_mse -version 0 -cuda 0 >> stgcn_point_pems03_version0.log  2>&1
```

Run Our modified quantile output by runing:

```shell
python -u qmain2.py -model stgcn3 -data pems03 -note stgcn_quantile_pems03 -loss quantile -version 0 -cuda 0 >> stgcn_quantile_pems03_version0.log  2>&1
```

Run Our STQCL by runing:

```shell
python -u qmain_stacking.py -model stgcn3 -scl -qcl -tcl -wait_iter 1000 -scl_size 300 -scl_length 10 -tcl_size 300 -qcl_size 300 -data pems03 -note stgcn_stacking_pems03 -loss quantile -version 0 -cuda 0 >> stgcn_stacking_pems03_version0.log  2>&1
```


The external experiments are as follow:

|Dataset||Metric||STGCN|||STGCN+ STQCL|||STAEF|||STAEF+ STQCL||
|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|
|||Horizon|3|6|12|3|6|12|3|6|12|3|6|12|
||Point|RMSE|25.973|28.477|31.906|25.837|27.948|28.861|23.502|25.803|28.861|23.141|25.511|28.529|
|||MAE|14.839|16.146|18.429|14.623|15.915|18.069|14.327|15.510|17.287|14.028|15.241|16.973|
|PEMS03||MAPE|15.468|16.437|18.687|14.817|15.997|18.436|14.812|15.722|17.105|14.346|15.412|16.975|
||Quantile|Q10|3.450|3.805|4.427|3.393|3.762|4.399|3.443|3.912|4.566|3.381|3.844|4.475|
|||Q50|7.420|8.073|9.215|7.311|7.958|9.035|7.164|7.755|8.644|7.014|7.621|8.486|
|||Q90|3.657|4.048|4.763|3.547|3.918|4.512|3.335|3.661|4.098|3.262|3.582|4.026|
||Point|RMSE|33.334|36.538|41.745|32.400|35.366|40.057|30.984|33.837|37.618|30.349|33.178|36.735|
|||MAE|21.203|23.239|26.715|20.472|22.257|25.377|18.731|20.091|22.199|18.042|19.401|21.271|
|PEMS07||MAPE|9.214|10.215|11.815|8.987|9.695|11.202|8.665|10.638|12.873|8.249|10.086|12.095|
||Quantile|Q10|5.068|5.607|6.476|4.923|5.397|6.194|7.921|8.472|9.513|7.579|8.110|8.951|
|||Q50|10.602|11.619|13.358|10.236|11.129|12.688|9.366|10.046|11.099|9.021|9.701|10.636|
|||Q90|5.149|5.635|6.656|4.838|5.319|6.180|4.365|4.712|5.274|4.179|4.524|5.025|
||Point|RMSE|23.978|26.366|30.449|23.490|25.761|29.197|22.371|24.360|27.025|21.696|23.748|26.193|
|||MAE|15.616|16.997|19.725|15.182|16.457|18.806|13.577|14.415|15.927|12.933|13.864|15.230|
|PEMS08||MAPE|10.015|10.957|12.614|9.810|10.574|12.138|8.665|10.638|12.873|8.249|10.086|12.095|
||Quantile|Q10|3.667|4.026|4.591|3.576|3.894|4.412|3.221|3.465|3.894|3.072|3.368|3.776|
|||Q50|7.808|8.499|9.862|7.591|8.228|9.403|6.788|7.207|7.964|6.467|6.932|7.615|
|||Q90|3.695|4.086|4.964|3.571|3.959|4.706|3.190|3.452|3.907|3.021|3.282|3.661|
||Point|RMSE|2.862|3.830|4.694|2.800|3.749|4.549|2.788|3.652|4.318|2.736|3.595|4.237|
|||MAE|1.399|1.747|2.118|1.359|1.703|2.053|1.324|1.624|1.906|1.293|1.588|1.861|
|PEMSBAY||MAPE|3.013|3.978|5.034|2.922|3.899|4.947|2.839|3.691|4.510|2.756|3.595|4.382|
||Quantile|Q10|0.380|0.487|0.618|0.369|0.475|0.600|0.930|1.113|1.367|0.878|1.045|1.257|
|||Q50|0.700|0.873|1.059|0.679|0.851|1.027|0.662|0.812|0.953|0.647|0.794|0.931|
|||Q90|0.301|0.364|0.431|0.291|0.354|0.418|0.282|0.338|0.391|0.276|0.333|0.386|
